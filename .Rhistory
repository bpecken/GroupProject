rm(RAC)
RACresults
plot.new()
plot(RACresults, las = 1, cex.lab = 1.4, cex.axis = 1.25)
SimpDFin <- function(x = "") {
D = 0
N = sum(x)
for (n_i in x){
D = D + ((n_i(N))^2/(N(N-2))
}
return(D)
}
SimpDFin <- function(x = "") {
D = 0
N = sum(x)
for (n_i in x){
D = D + ((n_i(N))^2)/(N(N-2))
}
return(D)
}
D.inv <- 1/SimpD(site1)
SimpD <- function(x = "") {
D = 0
N = sum(x)
for (n_i in x){
D = D + (n_i^2)/(N^2)
}
return(D)
}
D.inv <- 1/SimpD(site1)
D.sub <- 1-SimpD(site1)
D.inv
D.sub
D.inv2 <- 1/SimpDFin(site1)
rm(list=ls())
getwd()
setwd("C:/Users/dusti/GitHub/QB2019_Brewer/2.Worksheets/5.AlphaDiversity")
install.packages("vegan")
require("vegan")
data(BCI)
str(BCI)
S.obs <- function(x = ""){
rowSums(x > 0) * 1
}
BCI <- BCI
BCI
site1 <- (BCI[1,])
site1
S.obs(site1)
specnumber(BCI[1,])
specnumber(BCI[4,])
C <- function(x = ""){
1 - (rowSums(x == 1) / rowSums(x))
}
C(BCI[,])
soilbac <- read.table("data/soilbac.txt", sep = "\t", header = TRUE, row.names = 1)
soilbac
soilbac.t <- as.data.frame(t(soilbac))
soilbac.t
soilbac1 <- soilbac.t[1,]
S.obs(soilbac1)
C(soilbac1)
Chao1 <- function(x = ""){
S.obs(x) + (sum(x == 1)^2) / (2*sum(x ==2))
}
Chao2 <- function(site = "", SbyS = ""){
SbyS = as.data.frame(SbyS)
x = SbyS[site, ]
SbyS.pa <- (SbyS > 0) * 1
Q1 = sum(colSums(SbyS.pa) == 1)
Q2 = sum(colSums(SbyS.pa) == 2)
Chao2 = S.obs(x) + (Q1^2) / (2*Q2)
return(Chao2)
}
ACE <- function(x = "", thresh = 10){
x <- x[x>0]
S.abund <- length(which(x > thresh))
S.rare <- length(which(x <= thresh))
singlt <- length(which(x == 1))
N.rare <- sum(x[which(x <= thresh)])
C.ace <- 1 - (singlt / N.rare)
i <- c(1:thresh)
count <- function(i, y){
length(y[y == i])
}
a.1 <- sapply(i, count, x)
f.1 <- (i * (i - 1)) * a.1
G.ace <- (S.rare/C.ace)*(sum(f.1)/(N.rare*(N.rare-1)))
S.ace <- S.abund + (S.rare/C.ace) + (singlt/C.ace) * max(G.ace,0)
return(S.ace)
}
Chao1(site1)
Chao1(soilbac1)
ACE(site1)
ACE(soilbac1)
Chao2(1, BCI)
Chao2(1, soilbac.t)
soilbac.S <- S.obs(soilbac.t)
soilbac.S
min.N <- min(rowSums(soilbac.t))
min.N
S.rarefy <- rarefy(x = soilbac.t, sample = min.N, se = TRUE)
install.packages("vegan")
rarecurve(x = soilbac.t, step = 20, col = "blue", cex = 0.6, las = 1)
abline(0, 1, col = 'red')
text(1500, 1500, "1:1", pos = 2, col = 'red')
RAC <- function(x = ""){
x = as.vector(x)
x.ab = x[x > 0]
x.ab.ranked = x.ab[order(x.ab, decreasing = TRUE)]
return(x.ab.ranked)
}
plot.new()
rac <- RAC(x = site1)
ranks <- as.vector(seq(1, length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1, 5.1, 4.1, 2.1))
plot(ranks, log(rac), type = 'p', axes = F,
xlab = "Rank in abundance", ylab = "Abundance",
las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.225,
labels = c(1, 2, 5, 10, 20), at = log(c(1,2,5,10,20)))
SimpE <- function(x = ""){
S <- S.obs(x)
x = as.data.frame(x)
D <- diversity(x, "inv")
E <- (D)/S
return(E)
}
SimpE(site1)
Evar <- function(x){
x <- as.vector(x[x > 0])
1 - (2/pi)*atan(var(log(x)))
}
Evar(site1)
ShanH <- function(x = ""){
H = 0
for (n_i in x) {
if(n_i > 0) {
p = n_i / sum(x)
H = H - p*log(p)
}
}
return(H)
}
ShanH(site1)
diversity(site1, index = "shannon")
SimpD <- function(x = "") {
D = 0
N = sum(x)
for (n_i in x){
D = D + (n_i^2)/(N^2)
}
return(D)
}
D.inv <- 1/SimpD(site1)
D.sub <- 1-SimpD(site1)
D.inv
D.sub
diversity(site1, "inv")
diversity(site1, "simp")
rac <- as.vector(site1[site1 > 0])
invD <- diversity(rac, "inv")
invD
Fisher <- fisher.alpha(rac)
Fisher
RACresults <- radfit(site1)
RACresults
plot.new()
plot(RACresults, las = 1, cex.lab = 1.4, cex.axis = 1.25)
D.inv2 <- 1/SimpDFin(site1)
SimpDFin <- function(x = "") {
D = 0
N = sum(x)
for (n_i in x){
D = D + ((n_i(N))^2)/(N(N-2))
}
return(D)
}
SimpDFin
D.inv2 <- 1/SimpDFin(site1)
D.inv2 <- 1/SimpD(site1)
rm(D.inv2)
D.inv2 <- 1/SimpDFin(site1)
SimpDFin <- function(x = "") {
D = 0
N = sum(x)
for (n_i in x){
D = D + (n_1*(n_1 -1))/ (N*(N-2))
}
return(D)
}
D.inv2 <- 1/SimpDFin(site1)
D.inv2 <- 1/SimpDFin(site1)
SimpDFin <- function(x = "") {
D = 0
N = sum(x)
for (n_i in x){
D = D + (n_i*(n_i -1))/ (N*(N-2))
}
return(D)
}
D.inv2 <- 1/SimpDFin(site1)
D.inv2
D.sub2 <- 1-SimpDFin(site1)
D.sub2
D <- SimpDFin(site1)
hist(site1)
site1
hist(BCI$1, 20)
c(site1)
site1
vector(site1[1:225])
vector(site1[,1])
hist(site1)
hist(x = site1)
hist(rac)
RAC(?)
?RAC()
rac <- RAC(x = site1)
ranks <- as.vector(seq(1, length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1, 5.1, 4.1, 2.1))
plot(ranks, log(rac), type = 'p', axes = F,
xlab = "Rank in abundance", ylab = "Abundance",
las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.225,
labels = c(1, 2, 5, 10, 20), at = log(c(1,2,5,10,20)))
hist(rac)
Woolly <- read.table("data/hf085-01-bird.csv", sep = "\,", header = TRUE, row.names = 1)
Woolly <- read.table("data/hf085-01-bird.csv", sep = ",", header = TRUE, row.names = 1)
Woolly <- read.table("data/hf085-01-bird.csv", sep = ",", header = TRUE, row.names = 1)
soilbac <- read.csv("data/soilbac.txt", sep = "\t", header = TRUE, row.names = 1)
Woolly <- read.csv("data/hf085-01-bird.csv", sep = ",", header = TRUE, row.names = 1)
Woolly <- read.csv(data/"hf085-01-bird.csv", sep = ",", header = TRUE, row.names = 1)
Woolly <- read.csv("data/"hf08501bird.csv", sep = ",", header = TRUE, row.names = 1)
Woolly <- read.csv("data/hf08501bird.csv", sep = ",", header = TRUE, row.names = 1)
Woolly <- read.csv("data/hf08501bird.csv", sep = ",", header = TRUE)
setwd("C:/Users/dusti/GitHub/QB2019_Brewer/2.Worksheets/5.AlphaDiversity")
Woolly <- read.csv("data/hf08501bird.csv", sep = ",", header = TRUE)
soilbac <- read.csv("data/soilbac.txt", sep = "\t", header = TRUE, row.names = 1)
soilbac <- read.table("data/soilbac.txt", sep = "\t", header = TRUE, row.names = 1)
soilbac <- read.table("data/soilbac.txt", sep = "\t", header = TRUE, row.names = 1)
soilbac <- read.table("data/soilbac.txt", sep = "\t", header = TRUE, row.names = 1)
Woolly <- read.csv("data/hf08501bird.csv", sep = ",", header = TRUE)
Woolly
library("evaluate", lib.loc="~/R/win-library/3.4")
```{r}
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)
install.packages("vegan")
install.packages("vegan")
r = getOption("repos")
r["CRAN"] = "http://cran.us.r-project.org"
options(repos = r)
install.packages("vegan")
library("knitr", lib.loc="~/R/win-library/3.4")
library("vegan", lib.loc="~/R/win-library/3.4")
rm(list=ls())
getwd()
setwd("C:/Users/dusti/GitHub/QB2019_Brewer/2.Worksheets/5.AlphaDiversity")
install.packages("vegan")
require("vegan")
data(BCI)
str(BCI)
S.obs <- function(x = ""){
rowSums(x > 0) * 1
}
BCI <- BCI
BCI
site1 <- (BCI[1,])
site1
S.obs(site1)
specnumber(BCI[1,])
specnumber(BCI[4,])
C <- function(x = ""){
1 - (rowSums(x == 1) / rowSums(x))
}
C(BCI[,])
soilbac <- read.table("data/soilbac.txt", sep = "\t", header = TRUE, row.names = 1)
soilbac
soilbac.t <- as.data.frame(t(soilbac))
soilbac.t
soilbac1 <- soilbac.t[1,]
S.obs(soilbac1)
C(soilbac1)
Chao1 <- function(x = ""){
S.obs(x) + (sum(x == 1)^2) / (2*sum(x ==2))
}
Chao2 <- function(site = "", SbyS = ""){
SbyS = as.data.frame(SbyS)
x = SbyS[site, ]
SbyS.pa <- (SbyS > 0) * 1
Q1 = sum(colSums(SbyS.pa) == 1)
Q2 = sum(colSums(SbyS.pa) == 2)
Chao2 = S.obs(x) + (Q1^2) / (2*Q2)
return(Chao2)
}
ACE <- function(x = "", thresh = 10){
x <- x[x>0]
S.abund <- length(which(x > thresh))
S.rare <- length(which(x <= thresh))
singlt <- length(which(x == 1))
N.rare <- sum(x[which(x <= thresh)])
C.ace <- 1 - (singlt / N.rare)
i <- c(1:thresh)
count <- function(i, y){
length(y[y == i])
}
a.1 <- sapply(i, count, x)
f.1 <- (i * (i - 1)) * a.1
G.ace <- (S.rare/C.ace)*(sum(f.1)/(N.rare*(N.rare-1)))
S.ace <- S.abund + (S.rare/C.ace) + (singlt/C.ace) * max(G.ace,0)
return(S.ace)
}
Chao1(site1)
Chao1(soilbac1)
ACE(site1)
ACE(soilbac1)
Chao2(1, BCI)
Chao2(1, soilbac.t)
soilbac.S <- S.obs(soilbac.t)
soilbac.S
min.N <- min(rowSums(soilbac.t))
min.N
S.rarefy <- rarefy(x = soilbac.t, sample = min.N, se = TRUE)
rarecurve(x = soilbac.t, step = 20, col = "blue", cex = 0.6, las = 1)
abline(0, 1, col = 'red')
text(1500, 1500, "1:1", pos = 2, col = 'red')
RAC <- function(x = ""){
x = as.vector(x)
x.ab = x[x > 0]
x.ab.ranked = x.ab[order(x.ab, decreasing = TRUE)]
return(x.ab.ranked)
}
plot.new()
rac <- RAC(x = site1)
ranks <- as.vector(seq(1, length(rac)))
opar <- par(no.readonly = TRUE)
par(mar = c(5.1, 5.1, 4.1, 2.1))
plot(ranks, log(rac), type = 'p', axes = F,
xlab = "Rank in abundance", ylab = "Abundance",
las = 1, cex.lab = 1.4, cex.axis = 1.25)
box()
axis(side = 1, labels = T, cex.axis = 1.25)
axis(side = 2, las = 1, cex.axis = 1.225,
labels = c(1, 2, 5, 10, 20), at = log(c(1,2,5,10,20)))
SimpE <- function(x = ""){
S <- S.obs(x)
x = as.data.frame(x)
D <- diversity(x, "inv")
E <- (D)/S
return(E)
}
SimpE(site1)
Evar <- function(x){
x <- as.vector(x[x > 0])
1 - (2/pi)*atan(var(log(x)))
}
Evar(site1)
ShanH <- function(x = ""){
H = 0
for (n_i in x) {
if(n_i > 0) {
p = n_i / sum(x)
H = H - p*log(p)
}
}
return(H)
}
ShanH(site1)
diversity(site1, index = "shannon")
SimpD <- function(x = "") {
D = 0
N = sum(x)
for (n_i in x){
D = D + (n_i^2)/(N^2)
}
return(D)
}
D.inv <- 1/SimpD(site1)
D.sub <- 1-SimpD(site1)
D.inv
D.sub
diversity(site1, "inv")
diversity(site1, "simp")
rac <- as.vector(site1[site1 > 0])
invD <- diversity(rac, "inv")
invD
Fisher <- fisher.alpha(rac)
Fisher
RACresults <- radfit(site1)
RACresults
plot.new()
plot(RACresults, las = 1, cex.lab = 1.4, cex.axis = 1.25)
install.packages("vegan")
install.packages("vegan")
install.packages("vegan")
require("vegan")
setwd("C:/Users/dusti/GitHub/QB2019_Brewer/2.Worksheets/5.AlphaDiversity")
install.packages("vegan", repos = "http://cran.us.r-project.org")
require("vegan")
install.packages("vegan", repos = "http://cran.us.r-project.org")
BCI
BCI <- data(BCI)
data(BCI)
library("vegan", lib.loc="~/R/win-library/3.4")
data(BCI)
BCI
install.packages("vegan", repos = "http://cran.us.r-project.org")
require("vegan")
install.packages("vegan", repos = "http://cran.us.r-project.org")
data(BCI)
data(BCI)
install.packages("vegan", repos = "http://cran.us.r-project.org")
require("vegan")
data(BCI)
str(BCI)
BCI
BCI
BCI <- data(BCI)
install.packages("vegan", repos = "http://cran.us.r-project.org")
install.packages("vegan", repos = "http://cran.us.r-project.org")
BCI <- data(BCI)
require("vegan")
BCI <- data(BCI)
BCI
data(BCI)
rm(list=ls())
getwd()
setwd("C:/Users/dusti/GitHub/QB2019_Brewer/2.Worksheets/5.AlphaDiversity")
install.packages("vegan", repos = "http://cran.us.r-project.org")
require("vegan")
install.packages("vegan", repos = "http://cran.us.r-project.org")
data(BCI)
data(BCI)
setwd("C:/Users/dusti/GitHub/QB2019_Brewer/2.Worksheets/5.AlphaDiversity")
install.packages("vegan", repos = "http://cran.us.r-project.org")
library("vegan")
data(BCI)
BCI
str(BCI)
View(soilbac1)
setwd("C:/Users/dusti/Box Sync/Personal Computer/Quantitative Biodiversity/Group Project/GroupProject")
rm(list=ls())
read.csv("ForagingGuildsDataFile.csv")
library(vegan)
library(psych)
library(corrplot)
install.packages("corrplot")
Guilds <- read.csv("ForagingGuildsDataFile.csv")
library(ggplot2)
str(Guilds)
Guilds.num <- Guilds[ ,4:5]
sem <- function(x){
sd(na.omit(x))/sqrt(length(na.omit(x)))
}
summary(Guilds)
tapply(Guilds$Omn..16., Hi-A, mean)
rm(list=ls())
Guilds <- read.csv("ForagingGuildsDataFile.csv")
str(Guilds)
sem <- function(x){
sd(na.omit(x))/sqrt(length(na.omit(x)))
}
tapply(Guilds$Omn..16., HiA, mean)
tapply(Guilds$Omn..16., Guilds$HiA, mean)
rm(list=ls())
Guilds <- read.csv("ForagingGuildsDataFile.csv")
sem <- function(x){
sd(na.omit(x))/sqrt(length(na.omit(x)))
}
sem <- function(x){
sd(na.omit(x))/sqrt(length(na.omit(x)))
}
Guilds <- read.csv("ForagingGuildsDataFile.csv")
tapply(Guilds$Omn_16, Guilds$HiA, mean)
tapply(Guilds$Omn_16, Guilds$mortality.class, mean)
Omnivores.Mean <- tapply(Guilds$Omn_16, Guilds$mortality.class, mean)
Insectivores.Mean <- tapply(Guilds$Ins_29, Guilds$mortality.class, mean)
Insectivores.Mean
Omnivores.SE <- tapply(Guilds$Omn_16, Guilds$mortality.class, sem)
Insectivores.SE <- tapply(Guilds$Ins_29, Guilds$mortality.class, sem)
OmnivorePlot <- barplot(Omnivores.Mean, ylim = c(0, round(max(Omnivores.Mean), digits = 0)),
pch = 15, cex = 1.25, las = 1, cex.lab = 1.4, cex.axis = 1.25,
xlab = "mortality class",
ylab = "mean site abundance",
names.arg = c("low", "medium", "high A", "high B"))
arrows(x0 = bp1, y0 = Omnivores.Mean, y1 = Omnivores.Mean - Omnivores.SE, angle = 90,
length = 0.1, lwd = 1)
arrows(x0 = bp1, y0 = Omnivores.Mean , y1 = Omnivores.Mean + Omnivores.SE, angle = 90,
length = 0.1, lwd = 1)
#Make barplots
OmnivorePlot <- barplot(Omnivores.Mean, ylim = c(0, 5 , digits = 0)),
pch = 15, cex = 1.25, las = 1, cex.lab = 1.4, cex.axis = 1.25,
xlab = "mortality class",
ylab = "mean site abundance",
names.arg = c("low", "medium", "high A", "high B"))
OmnivorePlot <- barplot(Omnivores.Mean, ylim = c(0, 5 , digits = 0)),
pch = 15, cex = 1.25, las = 1, cex.lab = 1.4, cex.axis = 1.25,
xlab = "mortality class",
ylab = "mean site abundance",
names.arg = c("low", "medium", "high A", "high B"))
arrows(x0 = bp1, y0 = Omnivores.Mean, y1 = Omnivores.Mean - Omnivores.SE, angle = 90,
length = 0.1, lwd = 1)
arrows(x0 = bp1, y0 = Omnivores.Mean , y1 = Omnivores.Mean + Omnivores.SE, angle = 90,
length = 0.1, lwd = 1)
